# å…±é€šUI ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨­è¨ˆæ›¸

## 1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰è¨­è¨ˆ

### 1.1 ç”»é¢ä¸€è¦§

| ç”»é¢ID | ç”»é¢å | ãƒ‘ã‚¹ | èª¬æ˜ |
|--------|--------|------|------|
| - | ãƒ˜ãƒƒãƒ€ãƒ¼ | å…¨ãƒšãƒ¼ã‚¸å…±é€š | ã‚°ãƒ­ãƒ¼ãƒãƒ«ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ¤œç´¢ã€é€šçŸ¥ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼ï¼‰ |
| - | ã‚µã‚¤ãƒ‰ãƒãƒ¼ | å…¨ãƒšãƒ¼ã‚¸å…±é€š | ã‚µã‚¤ãƒ‰ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆæ¨©é™ãƒ™ãƒ¼ã‚¹è¡¨ç¤ºï¼‰ |
| notifications | é€šçŸ¥ä¸€è¦§ | /notifications | å…¨é€šçŸ¥ä¸€è¦§ãƒšãƒ¼ã‚¸ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ |

### 1.2 ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ

```text
features/common/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ Header/
â”‚   â”‚   â”œâ”€â”€ Header.tsx
â”‚   â”‚   â”œâ”€â”€ UserMenu.tsx
â”‚   â”‚   â”œâ”€â”€ NotificationBell.tsx
â”‚   â”‚   â”œâ”€â”€ NotificationBadge.tsx
â”‚   â”‚   â”œâ”€â”€ NotificationDropdown.tsx
â”‚   â”‚   â”œâ”€â”€ GlobalSearch.tsx
â”‚   â”‚   â”œâ”€â”€ SearchInput.tsx
â”‚   â”‚   â”œâ”€â”€ SearchDropdown.tsx
â”‚   â”‚   â””â”€â”€ SearchResultItem.tsx
â”‚   â”œâ”€â”€ Sidebar/
â”‚   â”‚   â”œâ”€â”€ Sidebar.tsx
â”‚   â”‚   â”œâ”€â”€ SidebarSection.tsx
â”‚   â”‚   â”œâ”€â”€ SidebarItem.tsx
â”‚   â”‚   â””â”€â”€ ProjectNavigator.tsx
â”‚   â””â”€â”€ Layout/
â”‚       â””â”€â”€ AppLayout.tsx
â”œâ”€â”€ hooks/
â”‚   â”œâ”€â”€ useUserContext.ts
â”‚   â”œâ”€â”€ usePermissions.ts
â”‚   â”œâ”€â”€ useNavigation.ts
â”‚   â”œâ”€â”€ useGlobalSearch.ts
â”‚   â”œâ”€â”€ useSearchDebounce.ts
â”‚   â”œâ”€â”€ useNotifications.ts
â”‚   â”œâ”€â”€ useUnreadCount.ts
â”‚   â””â”€â”€ useNotificationPolling.ts
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ UserContextProvider.tsx
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ userContextApi.ts
â”‚   â”œâ”€â”€ searchApi.ts
â”‚   â””â”€â”€ notificationApi.ts
â””â”€â”€ types/
    â”œâ”€â”€ userContext.ts
    â”œâ”€â”€ search.ts
    â””â”€â”€ notification.ts
```

---

## 2. ã‚µã‚¤ãƒ‰ãƒãƒ¼è¨­è¨ˆ

### 2.1 ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹æˆ

| ã‚»ã‚¯ã‚·ãƒ§ãƒ³ID | ã‚»ã‚¯ã‚·ãƒ§ãƒ³å | å¿…è¦æ¨©é™ | ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›® |
|-------------|-------------|---------|------------|
| dashboard | ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | user | ãƒ›ãƒ¼ãƒ  |
| project | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç† | user | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ |
| analysis | å€‹åˆ¥æ–½ç­–åˆ†æ | user | åˆ†æã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§ã€æ–°è¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ä½œæˆ |
| driver-tree | ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ãƒ„ãƒªãƒ¼ | user | ãƒ„ãƒªãƒ¼ä¸€è¦§ã€æ–°è¦ãƒ„ãƒªãƒ¼ä½œæˆã€ã‚«ãƒ†ã‚´ãƒªãƒã‚¹ã‚¿ |
| file | ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç† | user | ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã€ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ |
| system-admin | ã‚·ã‚¹ãƒ†ãƒ ç®¡ç† | system_admin | ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã€ãƒ­ãƒ¼ãƒ«ç®¡ç†ã€æ¤œè¨¼ã‚«ãƒ†ã‚´ãƒªã€èª²é¡Œãƒã‚¹ã‚¿ |
| monitoring | ç›£è¦–ãƒ»é‹ç”¨ | system_admin | ã‚·ã‚¹ãƒ†ãƒ çµ±è¨ˆã€æ“ä½œå±¥æ­´ã€ç›£æŸ»ãƒ­ã‚°ã€å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ |
| operations | ã‚·ã‚¹ãƒ†ãƒ é‹ç”¨ | system_admin | ã‚·ã‚¹ãƒ†ãƒ è¨­å®šã€é€šçŸ¥ç®¡ç†ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€ä¸€æ‹¬æ“ä½œã€ãƒ‡ãƒ¼ã‚¿ç®¡ç†ã€ã‚µãƒãƒ¼ãƒˆãƒ„ãƒ¼ãƒ« |

### 2.2 æ¨©é™ãƒ™ãƒ¼ã‚¹è¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯

```typescript
// components/Sidebar/Sidebar.tsx
export function Sidebar() {
  const { userContext } = useUserContext();
  const visibleSections = userContext?.sidebar.visibleSections ?? [];

  return (
    <aside className="sidebar">
      {visibleSections.includes('dashboard') && <DashboardSection />}
      {visibleSections.includes('project') && <ProjectSection />}
      {visibleSections.includes('analysis') && <AnalysisSection />}
      {visibleSections.includes('driver-tree') && <DriverTreeSection />}
      {visibleSections.includes('file') && <FileSection />}
      {visibleSections.includes('system-admin') && <SystemAdminSection />}
      {visibleSections.includes('monitoring') && <MonitoringSection />}
      {visibleSections.includes('operations') && <OperationsSection />}
    </aside>
  );
}
```

### 2.3 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‹•çš„é·ç§»

| æ¡ä»¶ | é·ç§»å…ˆ | URL |
|-----|-------|-----|
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•° = 0 | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ï¼ˆç©ºçŠ¶æ…‹ï¼‰ | /projects |
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•° = 1 | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè©³ç´° | /projects/{projectId} |
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•° > 1 | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§ | /projects |

```typescript
// components/Sidebar/ProjectNavigator.tsx
export function ProjectNavigator() {
  const { userContext } = useUserContext();
  const router = useRouter();

  const handleProjectClick = () => {
    const nav = userContext?.navigation;

    if (nav?.projectNavigationType === 'detail' && nav.defaultProjectId) {
      router.push(`/projects/${nav.defaultProjectId}`);
    } else {
      router.push('/projects');
    }
  };

  return (
    <SidebarItem
      icon="ğŸ“"
      label={
        userContext?.navigation.projectNavigationType === 'detail'
          ? userContext.navigation.defaultProjectName ?? 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ'
          : 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä¸€è¦§'
      }
      onClick={handleProjectClick}
    />
  );
}
```

---

## 3. ãƒ˜ãƒƒãƒ€ãƒ¼è¨­è¨ˆ

### 3.1 ãƒ˜ãƒƒãƒ€ãƒ¼ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ§‹æˆ

| ç”»é¢é …ç›® | è¡¨ç¤ºå½¢å¼ | APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å¤‰æ›å‡¦ç† |
|---------|---------|------------------|---------------------|---------|
| ãƒ¦ãƒ¼ã‚¶ãƒ¼å | ãƒ†ã‚­ã‚¹ãƒˆ | GET /user_account/me/context | user.displayName | - |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ãƒã‚¿ãƒ¼ | ã‚¤ãƒ‹ã‚·ãƒ£ãƒ« | GET /user_account/me/context | user.displayName | å…ˆé ­2æ–‡å­— |
| é€šçŸ¥ãƒãƒƒã‚¸ | ãƒãƒƒã‚¸ | GET /user_account/me/context | notifications.unreadCount | 0ã®å ´åˆéè¡¨ç¤º |
| ç®¡ç†è€…ãƒãƒƒã‚¸ | ãƒãƒƒã‚¸ | GET /user_account/me/context | permissions.isSystemAdmin | trueã®å ´åˆè¡¨ç¤º |

### 3.2 ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒ‹ãƒ¥ãƒ¼

| ãƒ¡ãƒ‹ãƒ¥ãƒ¼é …ç›® | è¡¨ç¤ºæ¡ä»¶ | é·ç§»å…ˆ |
|------------|---------|-------|
| ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ« | å¸¸æ™‚ | /settings/profile |
| è¨­å®š | å¸¸æ™‚ | /settings |
| ç®¡ç†ãƒ‘ãƒãƒ« | isSystemAdmin | /admin |
| ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ | å¸¸æ™‚ | Azure AD logout |

---

## 4. ã‚°ãƒ­ãƒ¼ãƒãƒ«æ¤œç´¢è¨­è¨ˆ

### 4.1 æ¤œç´¢å…¥åŠ›

| ç”»é¢é …ç›® | å…¥åŠ›å½¢å¼ | APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ |
|---------|---------|------------------|---------------------|---------------|
| æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ | ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ› | GET /search | q | 2æ–‡å­—ä»¥ä¸Šã§æ¤œç´¢å®Ÿè¡Œ |
| ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼è¡¨ç¤º | kbdè¦ç´  | - | - | Ctrl+K / Cmd+K |
| ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³ | ã‚¢ã‚¤ã‚³ãƒ³ãƒœã‚¿ãƒ³ | - | - | å…¥åŠ›ã‚¯ãƒªã‚¢ |

### 4.2 æ¤œç´¢çµæœãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³

| ç”»é¢é …ç›® | è¡¨ç¤ºå½¢å¼ | APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å¤‰æ›å‡¦ç† |
|---------|---------|------------------|---------------------|---------|
| æ¤œç´¢çµæœä»¶æ•° | ãƒ†ã‚­ã‚¹ãƒˆ | GET /search | total | "nä»¶" å½¢å¼ |
| çµæœã‚¢ã‚¤ãƒ†ãƒ ï¼ˆã‚¢ã‚¤ã‚³ãƒ³ï¼‰ | ã‚¢ã‚¤ã‚³ãƒ³ | GET /search | results[].type | typeâ†’çµµæ–‡å­—ãƒãƒƒãƒ”ãƒ³ã‚° |
| çµæœã‚¢ã‚¤ãƒ†ãƒ ï¼ˆåå‰ï¼‰ | ãƒ†ã‚­ã‚¹ãƒˆ | GET /search | results[].highlightedText | HTMLã¨ã—ã¦ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° |
| çµæœã‚¢ã‚¤ãƒ†ãƒ ï¼ˆèª¬æ˜ï¼‰ | ãƒ†ã‚­ã‚¹ãƒˆ | GET /search | results[].description | 50æ–‡å­—ã§åˆ‡ã‚Šè©°ã‚ |
| çµæœã‚¢ã‚¤ãƒ†ãƒ ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåï¼‰ | ãƒ†ã‚­ã‚¹ãƒˆ | GET /search | results[].projectName | è¦ªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¡¨ç¤º |
| çµæœã‚¢ã‚¤ãƒ†ãƒ ï¼ˆæ›´æ–°æ—¥æ™‚ï¼‰ | ãƒ†ã‚­ã‚¹ãƒˆ | GET /search | results[].updatedAt | ç›¸å¯¾æ™‚é–“è¡¨ç¤º |
| ç©ºçŠ¶æ…‹ | ã‚¢ã‚¤ã‚³ãƒ³+ãƒ†ã‚­ã‚¹ãƒˆ | - | - | æ¤œç´¢çµæœãªã—ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ |

### 4.3 æ¤œç´¢ã‚¿ã‚¤ãƒ—ã‚¢ã‚¤ã‚³ãƒ³ãƒãƒƒãƒ”ãƒ³ã‚°

| type | ã‚¢ã‚¤ã‚³ãƒ³ | èª¬æ˜ |
|------|---------|------|
| project | ğŸ“ | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ |
| session | ğŸ“Š | åˆ†æã‚»ãƒƒã‚·ãƒ§ãƒ³ |
| file | ğŸ“„ | ãƒ•ã‚¡ã‚¤ãƒ« |
| tree | ğŸŒ³ | ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ãƒ„ãƒªãƒ¼ |

### 4.4 æ¤œç´¢ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ

| ã‚­ãƒ¼ | å‹•ä½œ |
|------|------|
| Ctrl+K / Cmd+K | æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ |
| â†‘ | å‰ã®çµæœã‚’é¸æŠ |
| â†“ | æ¬¡ã®çµæœã‚’é¸æŠ |
| Enter | é¸æŠä¸­ã®çµæœã«é·ç§» |
| Esc | ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚’é–‰ã˜ã‚‹ |

---

## 5. é€šçŸ¥è¨­è¨ˆ

### 5.1 é€šçŸ¥ãƒ™ãƒ«ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

| ç”»é¢é …ç›® | è¡¨ç¤ºå½¢å¼ | APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å¤‰æ›å‡¦ç† |
|---------|---------|------------------|---------------------|---------|
| é€šçŸ¥ãƒ™ãƒ«ã‚¢ã‚¤ã‚³ãƒ³ | ã‚¢ã‚¤ã‚³ãƒ³ãƒœã‚¿ãƒ³ | - | - | ğŸ”” |
| æœªèª­ãƒãƒƒã‚¸ | ãƒãƒƒã‚¸ | GET /notifications | unreadCount | 0ã®å ´åˆéè¡¨ç¤ºã€99+è¡¨ç¤º |

### 5.2 é€šçŸ¥ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³

| ç”»é¢é …ç›® | è¡¨ç¤ºå½¢å¼ | APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ | ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ | å¤‰æ›å‡¦ç† |
|---------|---------|------------------|---------------------|---------|
| ãƒ˜ãƒƒãƒ€ãƒ¼ã‚¿ã‚¤ãƒˆãƒ« | ãƒ†ã‚­ã‚¹ãƒˆ | - | - | "é€šçŸ¥" |
| ã™ã¹ã¦æ—¢èª­ãƒœã‚¿ãƒ³ | ãƒªãƒ³ã‚¯ãƒœã‚¿ãƒ³ | PATCH /notifications/read-all | - | æœªèª­ãŒã‚ã‚‹å ´åˆã®ã¿è¡¨ç¤º |
| é€šçŸ¥ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆã‚¢ã‚¤ã‚³ãƒ³ï¼‰ | ã‚¢ã‚¤ã‚³ãƒ³ | GET /notifications | notifications[].icon | çµµæ–‡å­—è¡¨ç¤º |
| é€šçŸ¥ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰ | ãƒ†ã‚­ã‚¹ãƒˆ | GET /notifications | notifications[].message | 1è¡Œè¡¨ç¤ºã€100æ–‡å­—åˆ‡ã‚Šè©°ã‚ |
| é€šçŸ¥ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆæ™‚é–“ï¼‰ | ãƒ†ã‚­ã‚¹ãƒˆ | GET /notifications | notifications[].createdAt | ç›¸å¯¾æ™‚é–“è¡¨ç¤º |
| é€šçŸ¥ã‚¢ã‚¤ãƒ†ãƒ ï¼ˆæœªèª­ãƒãƒ¼ã‚¯ï¼‰ | ã‚¹ã‚¿ã‚¤ãƒ« | GET /notifications | notifications[].isRead | æœªèª­æ™‚ã«èƒŒæ™¯è‰²å¤‰æ›´ |
| ç©ºçŠ¶æ…‹ | ã‚¢ã‚¤ã‚³ãƒ³+ãƒ†ã‚­ã‚¹ãƒˆ | - | - | "é€šçŸ¥ã¯ã‚ã‚Šã¾ã›ã‚“" |
| ãƒ•ãƒƒã‚¿ãƒ¼ãƒªãƒ³ã‚¯ | ãƒªãƒ³ã‚¯ | - | - | "ã™ã¹ã¦ã®é€šçŸ¥ã‚’è¦‹ã‚‹" |

### 5.3 é€šçŸ¥ã‚¿ã‚¤ãƒ—ã‚¢ã‚¤ã‚³ãƒ³ãƒãƒƒãƒ”ãƒ³ã‚°

| type | icon | èª¬æ˜ |
|------|------|------|
| member_added | ğŸ‘¥ | ãƒ¡ãƒ³ãƒãƒ¼è¿½åŠ  |
| member_removed | ğŸ‘¤ | ãƒ¡ãƒ³ãƒãƒ¼å‰Šé™¤ |
| session_complete | âœ… | ã‚»ãƒƒã‚·ãƒ§ãƒ³å®Œäº† |
| file_uploaded | ğŸ“„ | ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ |
| tree_updated | ğŸŒ³ | ãƒ„ãƒªãƒ¼æ›´æ–° |
| project_invitation | ğŸ“¨ | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ‹›å¾… |
| system_announcement | ğŸ“¢ | ã‚·ã‚¹ãƒ†ãƒ ãŠçŸ¥ã‚‰ã› |

### 5.4 é€šçŸ¥ãƒãƒ¼ãƒªãƒ³ã‚°è¨­å®š

| è¨­å®š | å€¤ | èª¬æ˜ |
|------|---|------|
| ãƒãƒ¼ãƒªãƒ³ã‚°é–“éš” | 60ç§’ | æœªèª­ä»¶æ•°ã®å®šæœŸå–å¾— |
| åˆæœŸå–å¾— | ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ | æœªèª­ä»¶æ•°ã‚’å³åº§ã«å–å¾— |
| å†å–å¾—ãƒˆãƒªã‚¬ãƒ¼ | ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³è¡¨ç¤ºæ™‚ | æœ€æ–°ã®é€šçŸ¥ã‚’å–å¾— |

---

## 6. ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆç®¡ç†

### 6.1 UserContextProvider

```typescript
interface UserContextState {
  userContext: UserContextResponse | null;
  isLoading: boolean;
  error: Error | null;
  refetch: () => Promise<void>;
}

export function UserContextProvider({ children }: { children: ReactNode }) {
  const [state, setState] = useState<UserContextState>({
    userContext: null,
    isLoading: true,
    error: null,
    refetch: async () => {},
  });

  useEffect(() => {
    fetchUserContext();
  }, []);

  return (
    <UserContext.Provider value={state}>
      {children}
    </UserContext.Provider>
  );
}
```

### 6.2 åˆæœŸåŒ–ãƒ•ãƒ­ãƒ¼

```text
1. ã‚¢ãƒ—ãƒªèµ·å‹• / ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰
2. UserContextProvider ãŒ GET /user_account/me/context ã‚’å‘¼ã³å‡ºã—
3. ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ state ã«ä¿å­˜
4. Header, Sidebar ãŒ state ã‚’å‚ç…§ã—ã¦è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆ
5. æ¨©é™ãŒãªã„å ´åˆã¯ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’éè¡¨ç¤º
6. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ•°ã«å¿œã˜ã¦ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’åˆ‡ã‚Šæ›¿ãˆ
```

---

## 7. APIå‘¼ã³å‡ºã—ã‚¿ã‚¤ãƒŸãƒ³ã‚°

| ãƒˆãƒªã‚¬ãƒ¼ | APIå‘¼ã³å‡ºã— | å‚™è€ƒ |
|---------|------------|------|
| ã‚¢ãƒ—ãƒªåˆæœŸåŒ– | GET /user_account/me/context | 1å›ã®ã¿ |
| ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰ | GET /user_account/me/context | ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡åŠ¹æ™‚ |
| ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸå¾Œ | GET /user_account/me/context | å¼·åˆ¶ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ |
| ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå‚åŠ /é›¢è„±å¾Œ | refetch() | ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³æ›´æ–° |
| æ¤œç´¢å…¥åŠ›å¤‰æ›´ | GET /search | 300msãƒ‡ãƒã‚¦ãƒ³ã‚¹ã€2æ–‡å­—ä»¥ä¸Š |
| ãƒ™ãƒ«ã‚¯ãƒªãƒƒã‚¯ | GET /notifications?limit=10 | ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ç”¨ |
| é€šçŸ¥ã‚¯ãƒªãƒƒã‚¯ | PATCH /notifications/{id}/read | æ—¢èª­åŒ– |
| ã™ã¹ã¦æ—¢èª­ã‚¯ãƒªãƒƒã‚¯ | PATCH /notifications/read-all | ä¸€æ‹¬æ—¢èª­ |
| 60ç§’ã”ã¨ | GET /notifications?limit=1 | ãƒãƒ¼ãƒªãƒ³ã‚°ï¼ˆæœªèª­ä»¶æ•°ï¼‰ |

---

## 8. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

| ã‚¨ãƒ©ãƒ¼ | å¯¾å¿œ |
|-------|------|
| 401 Unauthorized | ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ |
| 403 Forbidden | ã‚¢ã‚¯ã‚»ã‚¹æ‹’å¦ç”»é¢ã‚’è¡¨ç¤º |
| 500 Server Error | ã‚¨ãƒ©ãƒ¼ç”»é¢ã‚’è¡¨ç¤ºã€ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³ |
| Network Error | ã‚ªãƒ•ãƒ©ã‚¤ãƒ³è¡¨ç¤ºã€ãƒªãƒˆãƒ©ã‚¤ãƒœã‚¿ãƒ³ |

---

## 9. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®

| é …ç›® | å¯¾ç­– |
|-----|------|
| åˆæœŸãƒ­ãƒ¼ãƒ‰ | ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆAPIã¯è»½é‡ï¼ˆ1KBæœªæº€ï¼‰ |
| ã‚­ãƒ£ãƒƒã‚·ãƒ¥ | React Query ã§5åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥ |
| å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚° | useMemo ã§ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¡¨ç¤ºã‚’æœ€é©åŒ– |
| ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚º | ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯é…å»¶ãƒ­ãƒ¼ãƒ‰ |
| æ¤œç´¢ | 300msãƒ‡ãƒã‚¦ãƒ³ã‚¹ã§APIå‘¼ã³å‡ºã—ã‚’æœ€é©åŒ– |
| é€šçŸ¥ | 60ç§’ãƒãƒ¼ãƒªãƒ³ã‚°ã§è² è·è»½æ¸› |
